DR0:[20,1]LANDER.MAC;24                                                                                                        PAGE 8




  294
  295   ; DISPLAY THE WORLD
  296
  297   DISPLY: CLR R2                          ; COMPUTE VIEW TO BE DISPLAYED IN R2
  298           JSR PC,ALT
  299           MOV R1,ALTUDE
  300           CMP R1,#1000.
  301           BGE 1$
  302           MOV XPOS,R1
  303           CLR R0
  304           DIV #1000.,R0
  305           ASL R0
  306           MOV ALTSR(R0),R2
  307   1$:     CMP R2,VIEW                     ; IF VIEW CHANGED, WE RE-DISPLAY
  308           BEQ DISP0
  309           INC HDRFLG
  310           MOV R2,VIEW
  311   DISP0:  TST HDRFLG                      ; DO WE NEED TO RE-DISPLAY HEADERS
  312           BNE DISPL0
  313           JMP DISP1
  314   DISPL0: MOV #1,XPREV
  315           MOV #1,YPREV
  316           MOV #1,XRPREV
  317           MOV #1,YRPREV
  318           CLRSCR
  319           CLR HDRFLG
  320           SNDSTR #VBMS
  321           SNDSTR #XVELMS
  322           SNDSTR $YVELMSS
  323           SNDSTR #THRMS
  324           SNDSTR #XPOSMS
  325           SNDSTR #YPOSMS
  326           SNDSTR #ALTMS
  327           SNDSTR #FUELMS
  328
  329           MOV #49.,R5
  330           TST VIEW
  331           BNE DISPL2                      ; WHICH VIEW TO DISPLAY, LONG OR SHORT RANGE
  332
  333
